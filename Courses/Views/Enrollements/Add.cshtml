@model Courses.Models.Enrollement
<!--? slider Area Start-->
<section class="slider-area slider-area2">
    <div class="slider-active">
        <!-- Single Slider -->
        <div class="single-slider slider-height2">
            <div class="container">
                <div class="row">
                    <div class="col-xl-8 col-lg-11 col-md-12">
                        <div class="hero__caption hero__caption2">
                            <h1 data-animation="bounceIn" data-delay="0.2s">Check out your Upcoming Courses</h1>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<section class="about-area3 fix">
    <div class="support-wrapper align-items-center" style="margin-top: 35px; margin-bottom: 45px;">
        <div class="right-content3" style="width: 38%;">
            <div class="row justify-content-center">
                <div class="col-xl-7 col-lg-8">
                    <div class="section-tittle text-center mb-55">
                        <h2>Your Advisor</h2>
                    </div>
                </div>
            </div>
            <div>
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                <div class="input-group-icon border mt-10">
                    @*<div class="icon"><i class="fa fa-book" aria-hidden="true"></i></div>*@
                    <div class="form-select" id="default-select">
                        <select required id="dropDownList-example" class="form-control" style="height: calc(12.25rem + 9px); padding: 0.375rem 0.75rem; font-size: 1.5rem; line-height: 1.5; color: #020202; border: 4px solid #696eff; border-radius: 0.7rem;" multiple asp-items="ViewBag.Courses">
                            <option disabled selected value="0">-- Please Select Your Courses --</option>
                        </select>
                    </div>
                </div>
                @*<div class="input-group-icon border mt-10">
                        <div class="icon"><i class="fa fa-calculator" aria-hidden="true"></i></div>
                        <input asp-for="Grade" type="number" placeholder="Grade"
                               onfocus="this.placeholder = ''" onblur="this.placeholder = 'Grade'" required
                               class="single-input">
                    </div>*@
                <div class="mt-10 center" style="text-align: center; margin-top: 118px;">
                    <button onclick="confirm()" href="#" class="genric-btn primary circle">Get Suggestion</button>
                </div>
            </div>
        </div>

        <div class="left-content3" style="width: 56%;">
            <div class="row justify-content-center">
                <div class="col-xl-7 col-lg-8">
                    <div class="section-tittle text-center mb-55">
                        <h2>@ViewBag.Title</h2>
                    </div>
                </div>
            </div>
            @if (string.IsNullOrEmpty(ViewBag.Recommendation))
            {
                @if (ViewBag.Explore.Count > 2)
                {
                    <div style="text-align: center;" class="row">
                        @foreach (var course in ViewBag.Explore)
                        {

                            @*<div class="col-lg-4 col-md-6 col-sm-8">
                                <div class="single-services mb-30">
                                    <div class="features-icon">
                                        <img src="~/assets/img/icon/icon1.svg" alt="">
                                    </div>
                                    <div class="features-caption">
                                        <h3 style="margin-top: 13px;">@course.Name</h3>
                                        <p style="margin-bottom: 6px;">Code: @course.Code</p>
                                        <p style=" line-height: 7px;">Grade: @course.Grade</p>
                                    </div>
                                </div>
                            </div>*@
                        }



                    </div>
                }
                else
                {
                    <div style="text-align: right;" class="row">
                        @foreach (var course in ViewBag.Explore)
                        {
                            <div class="col-lg-4 col-md-6 col-sm-8">
                                <div class="single-services mb-30">
                                    <div class="features-icon">
                                        <img src="~/assets/img/icon/icon1.svg" alt="">
                                    </div>
                                    <div class="features-caption">
                                        <h3 style="margin-top: 13px;">@course.Name</h3>
                                        <p style="margin-bottom: 6px;">Code: @course.Code</p>
                                        <p style=" line-height: 7px;">Grade: @course.Grade</p>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                }
            }
            else
            {
                <div style="text-align: right;" class="row">
                        <div class="col-lg-4 col-md-6 col-sm-8">
                            <div class="single-services mb-30">
                                <div class="features-caption">
                                    <h3>@ViewBag.Recommendation</h3>
                                    <p>go to home page </p>
                                    <p>and explore our courses</p>
                                </div>
                            </div>
                        </div>
                </div>
            }
        </div>
    </div>
</section>


<a href="#" id="mod" hidden style="color:red;" data-placement="left" data-toggle="modal" data-target=".bd-example-modal-sm" title="Delete"><i class="pe-7s-trash"></i></a>
<!--Modal-->
<div class="modal fade bd-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content" style="margin-top: 77px;">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Success!</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p id="message"></p>
            </div>
            <div class="modal-footer">
                <button id="modalClose" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button id="modalBtn" type="button" class="btn btn-primary" onclick="ok()">OK</button>
            </div>
        </div>
    </div>
</div>
@section Scripts {
    <script>

        var confirm = function () {
            var list = document.getElementById("dropDownList-example").selectedOptions;
            var values = Array.from(list).map(({ value }) => parseInt(value));

            if (values[0] != 0 || values.length > 1) {
                var ids = [];
                for (var i = 0; i < values.length; i++) {
                    ids[i] = values[i]
                }
                console.log(ids)
                $.ajax({
                    type: "POST",
                    url: "/Enrollements/Add",
                    data: { ids },
                    success: function (data) {
                        if (data.result) {
                            success(data.message);
                            var list = document.getElementById("dropDownList-example").
                        } else {
                            failed(data.message);
                        }
                    },
                    error: function (response) {
                        failed("This Course with these PreCourses is Already exists!.");
                    }
                });
            } else {
                failed("You should select one Course.");
            }
        }

        var ok = function () {
            window.location.href = "/Courses/Create";
        }

        var stay = function () {
            document.getElementById("modalClose").click();
        }

        var success = function (message) {
            document.getElementById("exampleModalLongTitle").innerHTML = "Success!";
            document.getElementById("message").innerHTML = message;
            document.getElementById("mod").click();
            document.getElementById("modalBtn").setAttribute('onclick', 'ok()')
        }

        var failed = function (message) {
            document.getElementById("exampleModalLongTitle").innerHTML = "Failed";
            document.getElementById("message").innerHTML = message;
            document.getElementById("mod").click();
            document.getElementById("modalBtn").setAttribute('onclick', 'stay()')
        }
    </script>

}